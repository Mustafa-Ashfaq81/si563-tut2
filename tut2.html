<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SI 563 Tutorial 2</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .problem-container {
            background: white;
            padding: 30px;
            margin: 30px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            page-break-inside: avoid;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .question-text {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            line-height: 1.8;
        }
        .tasks {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .tasks h3 {
            margin-top: 0;
            color: #856404;
        }
        canvas {
            display: block;
            margin: 20px auto;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
        }
        .answer-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 20px 0;
            transition: background 0.3s;
        }
        .answer-button:hover {
            background: #2980b9;
        }
        .answer-button:active {
            background: #1c5f87;
        }
        .answer-section {
            display: none;
            background: #e8f5e9;
            padding: 25px;
            border-radius: 5px;
            border-left: 4px solid #4caf50;
            margin: 20px 0;
        }
        .answer-section.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .answer-section h3 {
            color: #2e7d32;
            margin-top: 0;
        }
        .answer-section p {
            line-height: 1.8;
            margin: 10px 0;
        }
        .answer-section ul {
            line-height: 1.8;
        }
        @media print {
            .problem-container {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
            .answer-button {
                display: none;
            }
            .answer-section {
                display: block !important;
            }
        }
    </style>
</head>
<body>
    <h1>SI 563 Tutorial 2</h1>
    
    <div class="problem-container">
        <h2>Problem 1: Information Sets and Multiple SPNE (20 points)</h2>
        
        <div class="question-text">
            <p>Consider the following extensive-form game with imperfect information:</p>
        </div>
        
        <canvas id="tree1" width="700" height="500"></canvas>
        
        <div class="question-text">
            <p><strong>Game Description:</strong></p>
            <ul>
                <li>Player 1 moves first and chooses either <strong>M</strong> or <strong>N</strong></li>
                <li>If Player 1 chooses <strong>N</strong>, the game ends with payoffs <strong>(1, 1)</strong></li>
                <li>If Player 1 chooses <strong>M</strong>, Player 1 moves again and chooses either <strong>L</strong> or <strong>R</strong></li>
                <li>After Player 1's second move (L or R), Player 2 chooses either <strong>U</strong> or <strong>D</strong></li>
                <li>Player 2 has imperfect information - they don't know whether Player 1 chose L or R</li>
                <li>Payoffs are written as (Player 1, Player 2)</li>
            </ul>
        </div>
        
        <div class="tasks">
            <h3>Tasks:</h3>
            <p><strong>(a)</strong> Identify all subgames in this game tree. (3 points)</p>
            <p><strong>(b)</strong> Find the Nash equilibrium of the subgame that starts after Player 1 chooses M. Show the normal form representation. (6 points)</p>
            <p><strong>(c)</strong> Use backward induction to find all Subgame Perfect Nash Equilibria (SPNE). Show your reasoning. (8 points)</p>
            <p><strong>(d)</strong> State the complete SPNE strategy profiles. (3 points)</p>
        </div>
        
        <button class="answer-button" onclick="toggleAnswer('answer1')">Show/Hide Answer</button>
        
        <div id="answer1" class="answer-section">
            <h3>Solution to Problem 1:</h3>
            
            <p><strong>(a) Subgames:</strong></p>
            <p>There are <strong>2 subgames (1 proper subgame)</strong>:</p>
            <ul>
                <li>The entire game (starting at Player 1's initial node)</li>
                <li>The proper subgame starting after Player 1 chooses M (the simultaneous-move subgame between Player 1's second move and Player 2's move)</li>
            </ul>
            
            <p><strong>(b) Normal Form Representation of the Subgame:</strong></p>
            <p>The subgame that starts after Player 1 chooses M is a simultaneous-move game between Player 1 (choosing L or R) and Player 2 (choosing U or D).</p>
            
            <div style="text-align: center; margin: 20px 0;">
                <table style="margin: 0 auto; border-collapse: collapse; font-size: 16px;">
                    <tr>
                        <td style="border: 2px solid #333; padding: 15px; background: #f0f0f0; font-weight: bold;"></td>
                        <td style="border: 2px solid #333; padding: 15px; background: #f0f0f0; font-weight: bold; text-align: center;">Player 2: U</td>
                        <td style="border: 2px solid #333; padding: 15px; background: #f0f0f0; font-weight: bold; text-align: center;">Player 2: D</td>
                    </tr>
                    <tr>
                        <td style="border: 2px solid #333; padding: 15px; background: #f0f0f0; font-weight: bold;">Player 1: L</td>
                        <td style="border: 2px solid #333; padding: 15px; text-align: center; background: #e8f5e9;">(1, 2)</td>
                        <td style="border: 2px solid #333; padding: 15px; text-align: center;">(3, 0)</td>
                    </tr>
                    <tr>
                        <td style="border: 2px solid #333; padding: 15px; background: #f0f0f0; font-weight: bold;">Player 1: R</td>
                        <td style="border: 2px solid #333; padding: 15px; text-align: center;">(1, 0)</td>
                        <td style="border: 2px solid #333; padding: 15px; text-align: center; background: #fff3e0;">(2, 2)</td>
                    </tr>
                </table>
            </div>
            
            <p><strong>Finding Nash Equilibrium in the Subgame:</strong></p>
            <p><strong>Player 2's best responses:</strong></p>
            <ul>
                <li>If Player 1 chooses L: Player 2 compares U (payoff 2) vs D (payoff 0) → Player 2 chooses <strong>U</strong></li>
                <li>If Player 1 chooses R: Player 2 compares U (payoff 0) vs D (payoff 2) → Player 2 chooses <strong>D</strong></li>
            </ul>
            
            <p><strong>Player 1's best responses:</strong></p>
            <ul>
                <li>If Player 2 chooses U: Player 1 compares L (payoff 1) vs R (payoff 1) → Player 1 is indifferent, both give payoff 1</li>
                <li>If Player 2 chooses D: Player 1 compares L (payoff 3) vs R (payoff 2) → Player 1 chooses <strong>L</strong></li>
            </ul>
            
            <p><strong>Subgame Nash Equilibrium:</strong> (L, U) with payoffs (1, 2)</p>
            <p>This is the unique pure strategy Nash equilibrium in the subgame.</p>
            
            <p><strong>(c) Backward Induction for SPNE:</strong></p>
            <p>Now that we know the subgame equilibrium is (L, U) with payoffs (1, 2), we work backwards:</p>
            
            <p><strong>Player 1's initial choice:</strong></p>
            <p>Player 1 compares:</p>
            <ul>
                <li>Choosing M: leads to subgame with payoffs (1, 2) → Player 1 gets <strong>1</strong></li>
                <li>Choosing N: leads directly to (1, 1) → Player 1 gets <strong>1</strong></li>
            </ul>
            
            <p>Since Player 1 gets the same payoff (1) from both choices, Player 1 is <strong>indifferent</strong> between M and N.</p>
            
            <p><strong>Two SPNE exist:</strong></p>
            <ul>
                <li><strong>SPNE 1:</strong> Player 1 chooses M, then L; Player 2 chooses U</li>
                <li><strong>SPNE 2:</strong> Player 1 chooses N; Player 2 chooses U (off-equilibrium path)</li>
            </ul>
            
            <p><strong>(d) Complete SPNE Strategy Profiles:</strong></p>
            <p><strong>SPNE 1:</strong> (M;L, U)</p>
            <ul>
                <li>Player 1: Choose M, then choose L</li>
                <li>Player 2: Choose U</li>
                <li>Equilibrium path: M → L → U</li>
                <li>Equilibrium payoffs: (1, 2)</li>
            </ul>
            
            <p><strong>SPNE 2:</strong> (N;L,U)</p>
            <ul>
                <li>Player 1: Choose N</li>
                <li>Player 2: Choose L if P1 chose L, choose U if P1 chose R (if subgame were reached)</li>
                <li>Equilibrium path: N</li>
                <li>Equilibrium payoffs: (1, 1)</li>
            </ul>
            
            <p><strong>Key Insight:</strong> The existence of two SPNE arises because Player 1 receives the same payoff (1) from both initial choices, making Player 1 indifferent between M and N. This indifference creates multiple equilibrium outcomes.</p>
        </div>
    </div>

    <div class="problem-container">
        <h2>Problem 2: Multiple Subgames Case (25 points)</h2>
        
        <div class="question-text">
            <p>Consider the sequential game represented by the game tree below (exactly as in the shared hand-drawn figure):</p>
        </div>
        
        <canvas id="tree2" width="700" height="500"></canvas>
        
        <div class="question-text">
            <p><strong>Game Description (matches the image):</strong></p>
            <ul>
                <li>Player 1 moves first and chooses either <strong>Z</strong> or <strong>W</strong>.</li>
                <li>If <strong>Z</strong>: Player 2 chooses <strong>C</strong> or <strong>D</strong>.
                    <ul>
                        <li>(Z,C) → <strong>(6, 4)</strong></li>
                        <li>(Z,D) → <strong>(3, 2)</strong></li>
                    </ul>
                </li>
                <li>If <strong>W</strong>: Player 2 first chooses <strong>A</strong> or <strong>B</strong>; then Player 1 moves but <em>does not observe</em> A vs B (both P1 nodes are in the same information set). Player 1 chooses <strong>X</strong> or <strong>Y</strong>.
                    <ul>
                        <li>(A,X) → <strong>(3, 0)</strong></li>
                        <li>(A,Y) → <strong>(8, 5)</strong></li>
                        <li>(B,X) → <strong>(4, 6)</strong></li>
                        <li>(B,Y) → <strong>(2, 1)</strong></li>
                    </ul>
                </li>
                <li>Payoffs are (Player 1, Player 2).</li>
            </ul>
        </div>
        
        <div class="tasks">
            <h3>Tasks:</h3>
            <p><strong>(a)</strong> Identify all subgames. (5 points)</p>
            <p><strong>(b)</strong> For each proper subgame, find the Nash equilibrium. Show best-response reasoning. (8 points)</p>
            <p><strong>(c)</strong> Use backward induction to find the SPNE(s) of the entire game. (7 points)</p>
            <p><strong>(d)</strong> State complete SPNE strategy profiles in the form: (P1 initial; P2 after Z; P2 after W; P1’s action at the W-information-set). (3 points)</p>
        </div>
        
        <button class="answer-button" onclick="toggleAnswer('answer2')">Show/Hide Answer</button>
        
        <div id="answer2" class="answer-section">
            <h3>Solution to Problem 2:</h3>
            
            <p><strong>(a) 3 Subgames:</strong></p>
            <ul>
                <li>The entire game (root).</li>
                <li><strong>Proper Subgame 1</strong> (after <strong>Z</strong>): P2 chooses C or D.</li>
                <li><strong>Proper Subgame 2</strong> (after <strong>W</strong>): P2 chooses A/B, then P1 (without observing A/B) chooses X/Y. P1’s two nodes are connected by an information set.</li>
            </ul>

            <p><strong>(b) Nash equilibrium in each proper subgame:</strong></p>
            <div class="question-text" style="background:#eef7ff">
                <p><em>Subgame 1 (after Z):</em> P2 compares payoffs: C gives 4 vs D gives 2 ⇒ <strong>C</strong> is strictly better.</p>
                <p><strong>Subgame-1 NE:</strong> C ⇒ outcome <strong>(6, 4)</strong>.</p>
            </div>

            <div class="question-text" style="background:#f6ffed">
                <p><em>Subgame 2 (after W):</em> Best-response arrows from the 2×2 payoff table:</p>
                <ul>
                    <li>If P1 plays <strong>X</strong>, P2 prefers <strong>B</strong> (6 &gt; 0).</li>
                    <li>If P1 plays <strong>Y</strong>, P2 prefers <strong>A</strong> (5 &gt; 1).</li>
                    <li>If P2 plays <strong>A</strong>, P1 prefers <strong>Y</strong> (8 &gt; 3).</li>
                    <li>If P2 plays <strong>B</strong>, P1 prefers <strong>X</strong> (4 &gt; 2).</li>
                </ul>
                <p><strong>⇒ Two pure-strategy NE:</strong> <strong>(A,Y)</strong> with payoffs <strong>(8,5)</strong>, and <strong>(B,X)</strong> with payoffs <strong>(4,6)</strong>.</p>
            </div>

            <p><strong>(c) Backward induction (visual cases):</strong></p>
            <div class="tasks">
                <p><strong>Case 1 — Subgame 2 continues at (B,X):</strong> continuation payoff under W is <strong>(4,6)</strong>. Compare with Z→C = <strong>(6,4)</strong>. Player 1 prefers <strong>Z</strong> (6 &gt; 4).</p>
                <p><strong>Case 2 — Subgame 2 continues at (A,Y):</strong> continuation payoff under W is <strong>(8,5)</strong>. Player 1 prefers <strong>W</strong> (8 &gt; 6).</p>
            </div>

            <p><strong>(d) Complete SPNE strategy profiles:</strong></p>
            <ul>
                <li><strong>SPNE-A (when Subgame 2 selects (B,X)):</strong> <br>
                    <strong>(Z;X, C;B)</strong> &nbsp;&nbsp;→ Equilibrium path: Z → C; payoffs <strong>(6,4)</strong>.
                </li>
                <li><strong>SPNE-B (when Subgame 2 selects (A,Y)):</strong> <br>
                    <strong>(W;Y, C;A)</strong> &nbsp;&nbsp;→ Equilibrium path: W → A → Y; payoffs <strong>(8,5)</strong>.
                </li>
            </ul>
        </div>
    </div>

    <div class="problem-container">
        <h2>Problem 3: No Pure Nash Equilibrium in Subgame (25 points)</h2>
        
        <div class="question-text">
            <p>Consider the following sequential game where Player 1 first decides whether to enter a market or fight:</p>
        </div>
        
        <canvas id="tree3" width="700" height="550"></canvas>
        
        <div class="question-text">
            <p><strong>Game Description:</strong></p>
            <ul>
                <li>Player 1 moves first and chooses either <strong>E</strong> (Enter) or <strong>F</strong> (Fight)</li>
                <li>If Player 1 chooses <strong>F</strong>, the game ends immediately with payoffs <strong>(2, 1.5)</strong></li>
                <li>If Player 1 chooses <strong>E</strong>, both players simultaneously play the following subgame:</li>
            </ul>
            
            <p style="text-align: center; margin: 20px 0;"><strong>Subgame Payoff Matrix (after E is chosen):</strong></p>
            <table style="margin: 0 auto; border-collapse: collapse;">
                <tr>
                    <td style="border: 1px solid #ddd; padding: 10px;"></td>
                    <td style="border: 1px solid #ddd; padding: 10px; text-align: center;"><strong>Player 2: X</strong></td>
                    <td style="border: 1px solid #ddd; padding: 10px; text-align: center;"><strong>Player 2: Y</strong></td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ddd; padding: 10px;"><strong>Player 1: A</strong></td>
                    <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">(3, 0)</td>
                    <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">(0, 3)</td>
                </tr>
                <tr>
                    <td style="border: 1px solid #ddd; padding: 10px;"><strong>Player 1: B</strong></td>
                    <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">(0, 3)</td>
                    <td style="border: 1px solid #ddd; padding: 10px; text-align: center;">(3, 0)</td>
                </tr>
            </table>
            
            <p style="margin-top: 15px;"><em>Note: This subgame has NO pure strategy Nash equilibrium.</em></p>
        </div>
        
        <div class="tasks">
            <h3>Tasks:</h3>
            <p><strong>(a)</strong> Verify that the subgame (after E is chosen) has no pure strategy Nash equilibrium by checking all four strategy profiles. (4 points)</p>
            <p><strong>(b)</strong> Find the mixed strategy Nash equilibrium of the subgame. Let p = probability that Player 1 plays A, and q = probability that Player 2 plays X. Show all work including indifference conditions. (8 points)</p>
            <p><strong>(c)</strong> Calculate the expected payoffs for both players in the mixed strategy Nash equilibrium of the subgame. (4 points)</p>
            <p><strong>(d)</strong> Using backward induction, determine whether Player 1 will choose E or F in the SPNE. Compare the expected payoff from E with the payoff from F. (5 points)</p>
            <p><strong>(e)</strong> State the complete SPNE strategy profile, including the mixed strategies in the subgame. (4 points)</p>
        </div>
        
        <button class="answer-button" onclick="toggleAnswer('answer3')">Show/Hide Answer</button>
        
        <div id="answer3" class="answer-section">
            <h3>Solution to Problem 3:</h3>
            
            <p><strong>(a) Verify No Pure Strategy Nash Equilibrium:</strong></p>
            <p>Check all four possible pure strategy profiles:</p>
            
            <p><strong>1. (A, X) → (3, 0):</strong></p>
            <ul>
                <li>Player 1: If Player 2 plays X, should Player 1 play A (payoff 3) or B (payoff 0)? A is better. ✓</li>
                <li>Player 2: If Player 1 plays A, should Player 2 play X (payoff 0) or Y (payoff 3)? Y is better. ✗</li>
                <li>Not a Nash equilibrium (Player 2 wants to deviate)</li>
            </ul>
            
            <p><strong>2. (A, Y) → (0, 3):</strong></p>
            <ul>
                <li>Player 1: If Player 2 plays Y, should Player 1 play A (payoff 0) or B (payoff 3)? B is better. ✗</li>
                <li>Not a Nash equilibrium (Player 1 wants to deviate)</li>
            </ul>
            
            <p><strong>3. (B, X) → (0, 3):</strong></p>
            <ul>
                <li>Player 1: If Player 2 plays X, should Player 1 play B (payoff 0) or A (payoff 3)? A is better. ✗</li>
                <li>Not a Nash equilibrium (Player 1 wants to deviate)</li>
            </ul>
            
            <p><strong>4. (B, Y) → (3, 0):</strong></p>
            <ul>
                <li>Player 1: If Player 2 plays Y, should Player 1 play B (payoff 3) or A (payoff 0)? B is better. ✓</li>
                <li>Player 2: If Player 1 plays B, should Player 2 play Y (payoff 0) or X (payoff 3)? X is better. ✗</li>
                <li>Not a Nash equilibrium (Player 2 wants to deviate)</li>
            </ul>
            
            <p><strong>Conclusion: No pure strategy Nash equilibrium exists.</strong></p>
            
            <p><strong>(b) Mixed Strategy Nash Equilibrium:</strong></p>
            <p>Let p = probability Player 1 plays A (and 1-p for B)</p>
            <p>Let q = probability Player 2 plays X (and 1-q for Y)</p>
            
            <p><strong>For Player 2 to mix, Player 2 must be indifferent between X and Y:</strong></p>
            <p>Expected payoff from X: E₂(X) = p(0) + (1-p)(3) = 3 - 3p</p>
            <p>Expected payoff from Y: E₂(Y) = p(3) + (1-p)(0) = 3p</p>
            <p>Set equal: 3 - 3p = 3p</p>
            <p>Solving: 3 = 6p → <strong>p = 1/2</strong></p>
            
            <p><strong>For Player 1 to mix, Player 1 must be indifferent between A and B:</strong></p>
            <p>Expected payoff from A: E₁(A) = q(3) + (1-q)(0) = 3q</p>
            <p>Expected payoff from B: E₁(B) = q(0) + (1-q)(3) = 3 - 3q</p>
            <p>Set equal: 3q = 3 - 3q</p>
            <p>Solving: 6q = 3 → <strong>q = 1/2</strong></p>
            
            <p><strong>Mixed Strategy Nash Equilibrium: (p*, q*) = (1/2, 1/2)</strong></p>
            <p>Each player plays each of their strategies with probability 1/2.</p>
            
            <p><strong>(c) Expected Payoffs in Mixed Strategy Equilibrium:</strong></p>
            
            <p><strong>Player 1's expected payoff:</strong></p>
            <p>E₁ = 3q = 3(1/2) = <strong>3/2 = 1.5</strong></p>
            <p>(Or equivalently: E₁ = 3 - 3q = 3(1/2) = 1.5)</p>
            
            <p><strong>Player 2's expected payoff:</strong></p>
            <p>E₂ = 3p = 3(1/2) = <strong>3/2 = 1.5</strong></p>
            <p>(Or equivalently: E₂ = 3 - 3p = 3(1/2) = 1.5)</p>
            
            <p><strong>Both players get expected payoff of 1.5 in the mixed strategy equilibrium.</strong></p>
            
            <p><strong>(d) Backward Induction - Will Player 1 Choose E or F?</strong></p>
            <p>Compare expected payoffs:</p>
            <ul>
                <li>Choosing F: Player 1 gets <strong>2</strong></li>
                <li>Choosing E: Player 1 expects <strong>1.5</strong> (from the mixed strategy equilibrium)</li>
            </ul>
            <p>Since 2 > 1.5, Player 1 prefers to choose <strong>F</strong>.</p>
            
            <p><strong>(e) Complete SPNE Strategy Profile:</strong></p>
            <p><strong>Player 1 chooses F at the initial node.</strong></p>
            <p><strong>Off-equilibrium behavior (if E were chosen):</strong> Both players would play the mixed strategy (1/2, 1/2) in the subgame.</p>
            
            <p><strong>Complete SPNE:</strong></p>
            <p><strong>(F; play A with probability 1/2 and B with probability 1/2 if E is chosen; play X with probability 1/2 and Y with probability 1/2 if E is chosen)</strong></p>
            
            <p><strong>Equilibrium outcome: F is chosen, game ends with payoffs (2, 1.5)</strong></p>
        </div>
    </div>

    <div class="problem-container">
        <h2>Problem 4: Information Sets and Subgame Perfect Nash Equilibrium (30 points)</h2>
        
        <div class="question-text">
            <p>Consider the following extensive-form game with imperfect information:</p>
        </div>
        
        <canvas id="tree4" width="800" height="600"></canvas>
        
        <div class="question-text">
            <p><strong>Game Description:</strong></p>
            <ul>
                <li>Player 1 moves first and chooses either <strong>A</strong> or <strong>B</strong></li>
                <li>Player 2 chooses either <strong>C</strong> or <strong>D</strong></li>
                <li>If Player 2 chooses <strong>C</strong>, the game ends with payoffs depending on Player 1's initial choice:
                    <ul>
                        <li>If P1 chose A: payoffs are <strong>(1, 2)</strong></li>
                        <li>If P1 chose B: payoffs are <strong>(7, 8)</strong></li>
                    </ul>
                </li>
                <li>If Player 2 chooses <strong>D</strong>, Player 1 gets to move again and chooses either <strong>E</strong> or <strong>F</strong>:
                    <ul>
                        <li>If P1 chose A initially and then E: payoffs are <strong>(3, 4)</strong></li>
                        <li>If P1 chose A initially and then F: payoffs are <strong>(5, 6)</strong></li>
                        <li>If P1 chose B initially and then E: payoffs are <strong>(9, 10)</strong></li>
                        <li>If P1 chose B initially and then F: payoffs are <strong>(11, 12)</strong></li>
                    </ul>
                </li>
                <li>Payoffs are written as (Player 1, Player 2)</li>
            </ul>
        </div>
        
        <div class="tasks">
            <h3>Tasks:</h3>
            <p><strong>(a)</strong> Identify all subgames in this game tree. (5 points)</p>
            <p><strong>(b)</strong> For each subgame, find the Nash equilibrium using backward induction. Show your reasoning clearly. (10 points)</p>
            <p><strong>(c)</strong> Find all Subgame Perfect Nash Equilibria (SPNE) of the entire game. (8 points)</p>
            <p><strong>(d)</strong> State the complete SPNE strategy profiles in the form: (Player 1's initial choice; Player 2's choice after A, Player 2's choice after B; Player 1's choice after (A,D), Player 1's choice after (B,D)). (4 points)</p>
            <p><strong>(e)</strong> What are the equilibrium payoffs for each SPNE? (3 points)</p>
        </div>
        
        <button class="answer-button" onclick="toggleAnswer('answer4')">Show/Hide Answer</button>
        
        <div id="answer4" class="answer-section">
            <h3>Solution to Problem 4:</h3>
            
            <p><strong>(a) Subgames:</strong></p>
            <p>There are <strong>3 subgames (2 proper subgames)</strong>:</p>
            <ul>
                <li>The entire game (starting at Player 1's initial node)</li>
                <li>Proper Subgame 1: Starting at Player 1's decision node after (A, D)</li>
                <li>Proper Subgame 2: Starting at Player 1's decision node after (B, D)</li>
            </ul>
            
            <p><strong>(b) Nash Equilibrium in Each Subgame:</strong></p>
            
            <p><strong>Subgame 1 (after A, D):</strong></p>
            <p>Player 1 compares:</p>
            <ul>
                <li>Choosing E: payoff = 3</li>
                <li>Choosing F: payoff = 5</li>
            </ul>
            <p>Since 5 > 3, Player 1's best response is <strong>F</strong>.</p>
            <p><strong>Nash equilibrium in Subgame 1: F</strong></p>
            
            <p><strong>Subgame 2 (after B, D):</strong></p>
            <p>Player 1 compares:</p>
            <ul>
                <li>Choosing E: payoff = 9</li>
                <li>Choosing F: payoff = 11</li>
            </ul>
            <p>Since 11 > 9, Player 1's best response is <strong>F</strong>.</p>
            <p><strong>Nash equilibrium in Subgame 2: F</strong></p>
            
            <p><strong>(c) Finding SPNE of the Entire Game:</strong></p>
            <p>Now we work backwards to find Player 2's optimal choices, knowing Player 1 will choose F in both subgames:</p>
            
            <p><strong>Player 2's decision after A:</strong></p>
            <p>Player 2 compares:</p>
            <ul>
                <li>Choosing C: payoff = 2</li>
                <li>Choosing D: leads to Player 1 choosing F → payoff = 6</li>
            </ul>
            <p>Since 6 > 2, Player 2's best response after A is <strong>D</strong>.</p>
            
            <p><strong>Player 2's decision after B:</strong></p>
            <p>Player 2 compares:</p>
            <ul>
                <li>Choosing C: payoff = 8</li>
                <li>Choosing D: leads to Player 1 choosing F → payoff = 12</li>
            </ul>
            <p>Since 12 > 8, Player 2's best response after B is <strong>D</strong>.</p>
            
            <p><strong>Player 1's initial decision:</strong></p>
            <p>Knowing that Player 2 will choose D after both A and B, and that Player 1 will choose F in both resulting subgames, Player 1 compares:</p>
            <ul>
                <li>Choosing A: leads to (A, D, F) → payoff = 5</li>
                <li>Choosing B: leads to (B, D, F) → payoff = 11</li>
            </ul>
            <p>Since 11 > 5, Player 1's optimal initial choice is <strong>B</strong>.</p>
            
            <p><strong>There is exactly ONE SPNE:</strong></p>
            <p><strong>(B;F;F, D)</strong></p>
            
            <p><strong>(d) Complete SPNE Strategy Profile:</strong></p>
            <p><strong>(B;F;F, D)</strong></p>
            <p>This means:</p>
            <ul>
                <li>Player 1 initially chooses B</li>
                <li>Player 2 chooses D after A (off-equilibrium path)</li>
                <li>Player 2 chooses D after B (on-equilibrium path)</li>
                <li>Player 1 chooses F after (A, D) (off-equilibrium path)</li>
                <li>Player 1 chooses F after (B, D) (on-equilibrium path)</li>
            </ul>
            
            <p><strong>(e) Equilibrium Payoffs:</strong></p>
            <p>Following the equilibrium path (B → D → F):</p>
            <p><strong>Payoffs: (11, 12)</strong></p>
            
            <p><strong>Key Insights:</strong></p>
            <ul>
                <li>Player 1 prefers B over A because it leads to higher payoffs in the continuation game</li>
                <li>Player 2 always prefers D over C because the continuation game gives higher payoffs</li>
                <li>Player 1 always chooses F in the final subgames because it maximizes their payoff</li>
                <li>The equilibrium path is B → D → F with payoffs (11, 12)</li>
            </ul>
        </div>
    </div>

    <div class="problem-container">
        <h2>Problem 5: The Hungry Lions Game (35 points)</h2>
        
        <div class="question-text">
            <p>Consider a hierarchical group of <strong>n hungry lions</strong> facing a prey. The game proceeds as follows:</p>
            <ul>
                <li>If Lion 1 does not eat the prey, the prey escapes and the game ends</li>
                <li>If Lion 1 eats the prey, it becomes fat and slow, and Lion 2 can eat Lion 1</li>
                <li>If Lion 2 does not eat Lion 1, the game ends</li>
                <li>If Lion 2 eats Lion 1, then Lion 3 can eat Lion 2, and so on...</li>
                <li>This continues until either a lion chooses not to eat, or we reach the last lion</li>
            </ul>
            
            <p><strong>Preferences:</strong></p>
            <ul>
                <li>Each lion prefers to <strong>eat</strong> than to be <strong>hungry</strong></li>
                <li>Each lion prefers to be <strong>hungry</strong> than to be <strong>eaten</strong></li>
            </ul>
            
            <p><strong>Payoff Structure:</strong></p>
            <ul>
                <li>Eat (E) = +1</li>
                <li>Not Eat (NE) = 0</li>
                <li>Be Eaten = -1</li>
            </ul>
        </div>
        
        <canvas id="tree5" width="900" height="500"></canvas>
        
        <div class="question-text">
            <p><strong>Game Description:</strong></p>
            <p>This is a sequential game where lions move in hierarchical order. Each lion can choose to eat the previous lion (if any) or not eat. The game ends when a lion chooses not to eat, or when we reach the last lion.</p>
        </div>
        
        <div class="tasks">
            <h3>Tasks:</h3>
            <p><strong>(a)</strong> Analyze the game for <strong>n = 2</strong> lions. Draw the game tree and find the Subgame Perfect Equilibrium (SPE). (8 points)</p>
            <p><strong>(b)</strong> Analyze the game for <strong>n = 3</strong> lions. Draw the game tree and find the SPE. (10 points)</p>
            <p><strong>(c)</strong> Analyze the game for <strong>n = 4</strong> lions. Find the SPE without drawing the full tree. (7 points)</p>
            <p><strong>(d)</strong> Generalize your findings: What is the SPE for any number <strong>n</strong> of lions? Provide a clear rule. (6 points)</p>
            <p><strong>(e)</strong> Explain the intuition behind your general result. Why does the pattern depend on whether n is odd or even? (4 points)</p>
        </div>
        
        <button class="answer-button" onclick="toggleAnswer('answer5')">Show/Hide Answer</button>
        
        <div id="answer5" class="answer-section">
            <h3>Solution to Problem 5:</h3>
            
            <p><strong>(a) Analysis for n = 2 Lions:</strong></p>
            <p><strong>Game Tree:</strong></p>
            <ul>
                <li>Lion 1 chooses: Eat (E) or Not Eat (NE)</li>
                <li>If Lion 1 chooses NE: Game ends, payoffs (0, 0)</li>
                <li>If Lion 1 chooses E: Lion 2 chooses E or NE</li>
                <li>If Lion 2 chooses E: Lion 2 eats Lion 1, payoffs (-1, 1)</li>
                <li>If Lion 2 chooses NE: Game ends, payoffs (1, 0)</li>
            </ul>
            
            <p><strong>Backward Induction:</strong></p>
            <p>At Lion 2's decision: Lion 2 compares eating (payoff 1) vs not eating (payoff 0). Since 1 > 0, Lion 2 chooses <strong>E</strong>.</p>
            <p>At Lion 1's decision: Lion 1 compares not eating (payoff 0) vs eating (which leads to Lion 2 eating Lion 1, payoff -1). Since 0 > -1, Lion 1 chooses <strong>NE</strong>.</p>
            
            <p><strong>SPE for n = 2:</strong> Lion 1 chooses NE, Lion 2 chooses E (if reached)</p>
            <p><strong>Equilibrium outcome:</strong> Lion 1 does not eat, game ends with payoffs (0, 0)</p>
            
            <p><strong>(b) Analysis for n = 3 Lions:</strong></p>
            <p><strong>Game Tree:</strong></p>
            <ul>
                <li>Lion 1 chooses: E or NE</li>
                <li>If Lion 1 chooses NE: Game ends, payoffs (0, 0, 0)</li>
                <li>If Lion 1 chooses E: Lion 2 chooses E or NE</li>
                <li>If Lion 2 chooses NE: Game ends, payoffs (1, 0, 0)</li>
                <li>If Lion 2 chooses E: Lion 3 chooses E or NE</li>
                <li>If Lion 3 chooses E: Lion 3 eats Lion 2, payoffs (-1, -1, 1)</li>
                <li>If Lion 3 chooses NE: Game ends, payoffs (-1, 1, 0)</li>
            </ul>
            
            <p><strong>Backward Induction:</strong></p>
            <p><strong>Stage 3 (Lion 3):</strong> Lion 3 compares eating (payoff 1) vs not eating (payoff 0). Since 1 > 0, Lion 3 chooses <strong>E</strong>.</p>
            <p><strong>Stage 2 (Lion 2):</strong> Lion 2 compares not eating (payoff 0) vs eating (which leads to Lion 3 eating Lion 2, payoff -1). Since 0 > -1, Lion 2 chooses <strong>NE</strong>.</p>
            <p><strong>Stage 1 (Lion 1):</strong> Lion 1 compares not eating (payoff 0) vs eating (which leads to Lion 2 not eating Lion 1, payoff 1). Since 1 > 0, Lion 1 chooses <strong>E</strong>.</p>
            
            <p><strong>SPE for n = 3:</strong> (E, NE, E)</p>
            <p><strong>Equilibrium outcome:</strong> Lion 1 eats, Lion 2 does not eat Lion 1, game ends with payoffs (1, 0, 0)</p>
            
            <p><strong>(c) Analysis for n = 4 Lions:</strong></p>
            <p>Using the same backward induction logic:</p>
            <p><strong>Stage 4 (Lion 4):</strong> Lion 4 chooses E (payoff 1 > 0)</p>
            <p><strong>Stage 3 (Lion 3):</strong> Lion 3 chooses NE (payoff 0 > -1)</p>
            <p><strong>Stage 2 (Lion 2):</strong> Lion 2 chooses E (payoff 1 > 0)</p>
            <p><strong>Stage 1 (Lion 1):</strong> Lion 1 chooses NE (payoff 0 > -1)</p>
            
            <p><strong>SPE for n = 4:</strong> (NE, E, NE, E)</p>
            <p><strong>Equilibrium outcome:</strong> Lion 1 does not eat, game ends with payoffs (0, 0, 0, 0)</p>
            
            <p><strong>(d) General Rule for Any n Lions:</strong></p>
            <p><strong>For n odd:</strong> The first lion eats, the second lion does not eat, and the game ends.</p>
            <p><strong>For n even:</strong> The first lion does not eat, and the game ends immediately.</p>
            
            <p><strong>Pattern:</strong></p>
            <ul>
                <li><strong>n = 1:</strong> Lion 1 eats (no one to eat him)</li>
                <li><strong>n = 2:</strong> Lion 1 does not eat</li>
                <li><strong>n = 3:</strong> Lion 1 eats, Lion 2 does not eat</li>
                <li><strong>n = 4:</strong> Lion 1 does not eat</li>
                <li><strong>n = 5:</strong> Lion 1 eats, Lion 2 does not eat</li>
                <li>And so on...</li>
            </ul>
            
            <p><strong>(e) Intuition Behind the Pattern:</strong></p>
            <p>The key insight is that each lion wants to avoid being eaten by the next lion. This creates a "chain of fear" that works backwards from the last lion.</p>
            
            <p><strong>For odd n:</strong> The last lion (nth) will always eat the previous lion because no one can eat him. This means the (n-1)th lion will not eat because he would be eaten. This pattern continues, so the 1st lion can safely eat because the 2nd lion will not eat him.</p>
            
            <p><strong>For even n:</strong> The last lion will eat the previous lion, so the (n-1)th lion will not eat, and so on. This means the 2nd lion will eat the 1st lion if the 1st lion eats. Therefore, the 1st lion prefers not to eat to avoid being eaten.</p>
            
            <p><strong>Key Insight:</strong> The equilibrium depends on whether the "chain of fear" ends with the first lion being safe (odd n) or vulnerable (even n).</p>
        </div>
    </div>

    <div class="problem-container">
        <h2>Problem 6: Farmers and Markets (15 points)</h2>
        
        <div class="question-text">
            <p>There are 25 farmers who must choose which of two markets to sell their produce at. At Market A, the total profit is given by g₁(M₁) = 14M₁ - M₁²/2 where M₁ is the number of farmers who select Market A. For Market B, the total profit is g₂(M₂) = 7M₂ where M₂ is the number of farmers who choose Market B. Assume that the total profit at a market is equally divided between all farmers who sell at that market. What is the Nash equilibrium?</p>
        </div>
        
        <div class="question-text">
            <p><strong>Problem Details:</strong></p>
            <ul>
                <li><strong>Total farmers:</strong> 25</li>
                <li><strong>Market A profit function:</strong> g₁(M₁) = 14M₁ - M₁²/2</li>
                <li><strong>Market B profit function:</strong> g₂(M₂) = 7M₂</li>
                <li><strong>Profit sharing:</strong> Total profit at each market is equally divided among farmers at that market</li>
                <li><strong>Constraint:</strong> M₁ + M₂ = 25</li>
            </ul>
        </div>
        
        <div class="tasks">
            <h3>Tasks:</h3>
            <p><strong>(a)</strong> Derive the profit per farmer at each market as a function of the number of farmers. (5 points)</p>
            <p><strong>(b)</strong> Find the Nash equilibrium by setting the profits equal. Show your work. (8 points)</p>
            <p><strong>(c)</strong> Verify your answer by checking that no farmer wants to switch markets. (2 points)</p>
        </div>
        
        <button class="answer-button" onclick="toggleAnswer('answer6')">Show/Hide Answer</button>
        
        <div id="answer6" class="answer-section">
            <h3>Solution to Problem 6:</h3>
            
            <p><strong>(a) Profit per Farmer at Each Market:</strong></p>
            
            <p><strong>Market A:</strong></p>
            <p>Total profit: g₁(M₁) = 14M₁ - M₁²/2</p>
            <p>Profit per farmer: g₁(M₁)/M₁ = (14M₁ - M₁²/2)/M₁ = 14 - M₁/2</p>
            
            <p><strong>Market B:</strong></p>
            <p>Total profit: g₂(M₂) = 7M₂</p>
            <p>Profit per farmer: g₂(M₂)/M₂ = 7M₂/M₂ = 7</p>
            
            <p><strong>(b) Finding the Nash Equilibrium:</strong></p>
            
            <p>The system will be in Nash equilibrium if no farmer wants to switch markets. This occurs when the profit per farmer is equal at both markets.</p>
            
            <p>Set the profits equal:</p>
            <p>14 - M₁/2 = 7</p>
            <p>14 - 7 = M₁/2</p>
            <p>7 = M₁/2</p>
            <p><strong>M₁ = 14</strong></p>
            
            <p>Since there are 25 farmers total:</p>
            <p>M₂ = 25 - M₁ = 25 - 14 = <strong>11</strong></p>
            
            <p><strong>(c) Verification:</strong></p>
            
            <p><strong>Profit per farmer at Market A:</strong></p>
            <p>14 - M₁/2 = 14 - 14/2 = 14 - 7 = <strong>7</strong></p>
            
            <p><strong>Profit per farmer at Market B:</strong></p>
            <p>7</p>
            
            <p>Since the profits are equal (7 = 7), no farmer wants to switch markets.</p>
            
            <p><strong>Answer:</strong> M₁ = 14 and M₂ = 11 is the Nash equilibrium.</p>
            
            <p><strong>Economic Interpretation:</strong></p>
            <p>At equilibrium, 14 farmers choose Market A and 11 farmers choose Market B. Each farmer earns a profit of 7, regardless of which market they choose. This equalization of profits ensures that no individual farmer has an incentive to switch markets, making this allocation a Nash equilibrium.</p>
        </div>
    </div>

    <script>
        // Tree 1: Information Sets and Multiple SPNE
        function drawTree1(ctx, canvas) {
            const w = canvas.width;
            const h = canvas.height;
            
            // Root node (Player 1)
            ctx.beginPath();
            ctx.arc(w/2, 80, 25, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('P1', w/2, 80);

            // N branch (right)
            ctx.beginPath();
            ctx.moveTo(w/2 + 20, 100);
            ctx.lineTo(500, 200);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText('N', 450, 140);

            // M branch (left)
            ctx.beginPath();
            ctx.moveTo(w/2 - 20, 100);
            ctx.lineTo(200, 200);
            ctx.stroke();
            ctx.fillText('M', 250, 140);

            // Terminal payoff for N
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('(1, 1)', 500, 220);

            // Player 1's second decision node (after M)
            ctx.beginPath();
            ctx.arc(200, 220, 25, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.fillText('P1', 200, 220);

            // L branch (left)
            ctx.beginPath();
            ctx.moveTo(180, 240);
            ctx.lineTo(100, 320);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText('L', 135, 270);

            // R branch (right)
            ctx.beginPath();
            ctx.moveTo(220, 240);
            ctx.lineTo(300, 320);
            ctx.stroke();
            ctx.fillText('R', 265, 270);

            // Player 2 nodes (connected by information set)
            // Left P2 node (after L)
            ctx.beginPath();
            ctx.arc(100, 340, 25, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            // ctx.fillText('P2', 100, 340);

            // Right P2 node (after R)
            ctx.beginPath();
            ctx.arc(300, 340, 25, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            // ctx.fillText('P2', 300, 340);

            // Information set (dashed oval connecting P2 nodes)
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.setLineDash([8, 8]);
            ctx.beginPath();
            ctx.ellipse(200, 340, 120, 30, 0, 0, 2*Math.PI);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Information set label
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('P2', 200, 340);

            // Left P2's branches (U and D)
            ctx.beginPath();
            ctx.moveTo(80, 360);
            ctx.lineTo(50, 450);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText('U', 55, 400);

            ctx.beginPath();
            ctx.moveTo(120, 360);
            ctx.lineTo(150, 450);
            ctx.stroke();
            ctx.fillText('D', 145, 400);

            // Right P2's branches (U and D)
            ctx.beginPath();
            ctx.moveTo(280, 360);
            ctx.lineTo(250, 450);
            ctx.stroke();
            ctx.fillText('U', 255, 400);

            ctx.beginPath();
            ctx.moveTo(320, 360);
            ctx.lineTo(350, 450);
            ctx.stroke();
            ctx.fillText('D', 345, 400);

            // Terminal payoffs
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('(1, 2)', 50, 470);
            ctx.fillText('(3, 0)', 150, 470);
            ctx.fillText('(1, 0)', 250, 470);
            ctx.fillText('(2, 2)', 350, 470);
        }

        // Tree 2: Multiple Subgames
        function drawTree2(ctx, canvas) {
            const w = canvas.width;
            const h = canvas.height;

            ctx.save();
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.font = 'bold 16px Arial';

            // Root: Player 1
            ctx.beginPath();
            ctx.arc(w/2, 70, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.fillText('1', w/2, 70);

            // Branch Z (left)
            ctx.beginPath();
            ctx.moveTo(w/2 - 15, 85);
            ctx.lineTo(200, 200);
            ctx.stroke();
            ctx.font = '14px Arial';
            ctx.fillText('Z', (w/2 + 200)/2 - 60, 135);

            // Branch W (right)
            ctx.beginPath();
            ctx.moveTo(w/2 + 15, 85);
            ctx.lineTo(500, 200);
            ctx.stroke();
            ctx.fillText('W', (w/2 + 500)/2 + 60, 135);

            // P2 after Z
            ctx.font = 'bold 16px Arial';
            ctx.beginPath();
            ctx.arc(200, 215, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.fillText('2', 200, 215);

            // P2 after W
            ctx.beginPath();
            ctx.arc(500, 215, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.fillText('2', 500, 215);

            // After Z: P2 → C (left) and D (right)
            ctx.font = '14px Arial';
            // C
            ctx.beginPath();
            ctx.moveTo(185, 230);
            ctx.lineTo(120, 360);
            ctx.stroke();
            ctx.fillText('C', 140, 290);
            // D
            ctx.beginPath();
            ctx.moveTo(215, 230);
            ctx.lineTo(280, 360);
            ctx.stroke();
            ctx.fillText('D', 260, 290);

            // Payoffs after Z
            ctx.font = 'bold 15px Arial';
            ctx.fillText('(6, 4)', 120, 385);
            ctx.fillText('(3, 2)', 280, 385);

            // After W: P2 → A (left) and B (right), then P1 (info set) → X/Y
            ctx.font = '14px Arial';
            // Edge to A
            ctx.beginPath();
            ctx.moveTo(485, 230);
            ctx.lineTo(420, 320);
            ctx.stroke();
            ctx.fillText('A', 445, 275);
            // Edge to B
            ctx.beginPath();
            ctx.moveTo(515, 230);
            ctx.lineTo(580, 320);
            ctx.stroke();
            ctx.fillText('B', 555, 275);

            // P1 node after A
            ctx.beginPath();
            ctx.arc(420, 335, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('1', 420, 335);

            // P1 node after B
            ctx.beginPath();
            ctx.arc(580, 335, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('1', 580, 335);

            // Information set connecting the two P1 nodes
            ctx.setLineDash([6,6]);
            ctx.beginPath();
            ctx.ellipse(500, 335, 95, 28, 0, 0, 2*Math.PI);
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.font = 'bold 12px Arial';
            ctx.fillText('P1 information set', 500, 300);

            // From P1 after A: X (left), Y (right)
            ctx.font = '14px Arial';
            ctx.beginPath();
            ctx.moveTo(405, 350);
            ctx.lineTo(360, 430);
            ctx.stroke();
            ctx.fillText('X', 375, 385);
            ctx.beginPath();
            ctx.moveTo(435, 350);
            ctx.lineTo(480, 430);
            ctx.stroke();
            ctx.fillText('Y', 465, 385);

            // From P1 after B: X (left), Y (right)
            ctx.beginPath();
            ctx.moveTo(565, 350);
            ctx.lineTo(520, 430);
            ctx.stroke();
            ctx.fillText('X', 540, 385);
            ctx.beginPath();
            ctx.moveTo(595, 350);
            ctx.lineTo(640, 430);
            ctx.stroke();
            ctx.fillText('Y', 625, 385);

            // Payoffs under W
            ctx.font = 'bold 15px Arial';
            ctx.fillText('(3, 0)', 360, 455); // (A,X)
            ctx.fillText('(8, 5)', 480, 455); // (A,Y)
            ctx.fillText('(4, 6)', 520, 455); // (B,X)
            ctx.fillText('(2, 1)', 640, 455); // (B,Y)

            ctx.restore();
        }

        // Tree 3: No Pure Nash
        function drawTree3(ctx, canvas) {
            const w = canvas.width;
            const h = canvas.height;
            
            // Root node (Player 1)
            ctx.beginPath();
            ctx.arc(w/2, 70, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('1', w/2, 70);

            // Left branch (E)
            ctx.beginPath();
            ctx.moveTo(w/2 - 15, 85);
            ctx.lineTo(220, 230);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '14px Arial';
            ctx.fillText('E', 270, 145);

            // Right branch (F)
            ctx.beginPath();
            ctx.moveTo(w/2 + 15, 85);
            ctx.lineTo(480, 230);
            ctx.stroke();
            ctx.fillText('F', 430, 145);

            // Terminal payoff for F
            ctx.fillStyle = 'black';
            ctx.font = 'bold 15px Arial';
            ctx.fillText('(2, 1.5)', 480, 255);

            // Draw game matrix box
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 2;
            ctx.strokeRect(70, 280, 300, 200);
            
            ctx.fillStyle = '#2c3e50';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Simultaneous Move Subgame', 220, 305);

            // Matrix labels
            ctx.font = '13px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Player 2', 260, 335);
            ctx.fillText('X', 220, 360);
            ctx.fillText('Y', 300, 360);
            
            ctx.save();
            ctx.translate(100, 410);
            ctx.rotate(-Math.PI/2);
            ctx.fillText('Player 1', 0, 0);
            ctx.restore();
            
            ctx.fillText('A', 140, 395);
            ctx.fillText('B', 140, 445);

            // Draw matrix grid
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 1;
            
            // Vertical lines
            ctx.beginPath();
            ctx.moveTo(180, 370);
            ctx.lineTo(180, 465);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(260, 370);
            ctx.lineTo(260, 465);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(340, 370);
            ctx.lineTo(340, 465);
            ctx.stroke();
            
            // Horizontal lines
            ctx.beginPath();
            ctx.moveTo(180, 370);
            ctx.lineTo(340, 370);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(180, 417);
            ctx.lineTo(340, 417);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(180, 465);
            ctx.lineTo(340, 465);
            ctx.stroke();

            // Payoffs in cells
            ctx.font = '13px Arial';
            ctx.fillText('(3, 0)', 220, 395);
            ctx.fillText('(0, 3)', 300, 395);
            ctx.fillText('(0, 3)', 220, 445);
            ctx.fillText('(3, 0)', 300, 445);
        }

        // Tree 4: Information Sets and SPNE
        function drawTree4(ctx, canvas) {
            const w = canvas.width;
            const h = canvas.height;
            
            // Root node (Player 1)
            ctx.beginPath();
            ctx.arc(w/2, 80, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('P1', w/2, 80);

            // Left branch (A)
            ctx.beginPath();
            ctx.moveTo(w/2 - 15, 95);
            ctx.lineTo(200, 200);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '14px Arial';
            ctx.fillText('A', 280, 140);

            // Right branch (B)
            ctx.beginPath();
            ctx.moveTo(w/2 + 15, 95);
            ctx.lineTo(600, 200);
            ctx.stroke();
            ctx.fillText('B', 520, 140);

            // Player 2 nodes (connected by information set)
            // Left P2 node
            ctx.beginPath();
            ctx.arc(200, 215, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('P2', 200, 215);

            // Right P2 node
            ctx.beginPath();
            ctx.arc(600, 215, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('P2', 600, 215);

            // Information set (dashed oval connecting P2 nodes)
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.ellipse(400, 215, 220, 40, 0, 0, 2*Math.PI);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Information set label
            ctx.fillStyle = 'black';
            ctx.font = 'bold 14px Arial';
            ctx.fillText('P2', 400, 200);

            // Left P2's branches (C and D)
            ctx.beginPath();
            ctx.moveTo(185, 230);
            ctx.lineTo(120, 350);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '14px Arial';
            ctx.fillText('C', 140, 280);

            ctx.beginPath();
            ctx.moveTo(215, 230);
            ctx.lineTo(280, 350);
            ctx.stroke();
            ctx.fillText('D', 260, 280);

            // Right P2's branches (C and D)
            ctx.beginPath();
            ctx.moveTo(585, 230);
            ctx.lineTo(520, 350);
            ctx.stroke();
            ctx.fillText('C', 540, 280);

            ctx.beginPath();
            ctx.moveTo(615, 230);
            ctx.lineTo(680, 350);
            ctx.stroke();
            ctx.fillText('D', 660, 280);

            // Terminal payoffs for C branches
            ctx.fillStyle = 'black';
            ctx.font = 'bold 15px Arial';
            ctx.fillText('(1, 2)', 120, 375);
            ctx.fillText('(7, 8)', 520, 375);

            // Player 1's final decision nodes after D
            // Left side (after A, D)
            ctx.beginPath();
            ctx.arc(280, 365, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('P1', 280, 365);

            // Right side (after B, D)
            ctx.beginPath();
            ctx.arc(680, 365, 20, 0, 2*Math.PI);
            ctx.fillStyle = 'white';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('P1', 680, 365);

            // Left P1's branches (E and F)
            ctx.beginPath();
            ctx.moveTo(265, 380);
            ctx.lineTo(200, 480);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '14px Arial';
            ctx.fillText('E', 220, 420);

            ctx.beginPath();
            ctx.moveTo(295, 380);
            ctx.lineTo(360, 480);
            ctx.stroke();
            ctx.fillText('F', 340, 420);

            // Right P1's branches (E and F)
            ctx.beginPath();
            ctx.moveTo(665, 380);
            ctx.lineTo(600, 480);
            ctx.stroke();
            ctx.fillText('E', 620, 420);

            ctx.beginPath();
            ctx.moveTo(695, 380);
            ctx.lineTo(760, 480);
            ctx.stroke();
            ctx.fillText('F', 740, 420);

            // Final terminal payoffs
            ctx.fillStyle = 'black';
            ctx.font = 'bold 15px Arial';
            ctx.fillText('(3, 4)', 200, 505);
            ctx.fillText('(5, 6)', 360, 505);
            ctx.fillText('(9, 10)', 600, 505);
            ctx.fillText('(11, 12)', 760, 505);
        }

        // Tree 5: Hungry Lions Game
        function drawTree5(ctx, canvas) {
            const w = canvas.width;
            const h = canvas.height;
            
            // Title
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Hungry Lions Game (n=3 example)', w/2, 30);
            
            // Root node (Lion 1) - centered
            ctx.beginPath();
            ctx.arc(w/2, 80, 25, 0, 2*Math.PI);
            ctx.fillStyle = '#ffeb3b';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('L1', w/2, 80);

            // Lion 1's branches
            // NE branch (left)
            ctx.beginPath();
            ctx.moveTo(w/2 - 20, 100);
            ctx.lineTo(150, 180);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText('NE', 200, 130);

            // E branch (right)
            ctx.beginPath();
            ctx.moveTo(w/2 + 20, 100);
            ctx.lineTo(650, 180);
            ctx.stroke();
            ctx.fillText('E', 600, 130);

            // Terminal payoff for NE
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('(0,0,0)', 150, 210);

            // Lion 2 node (moved left to fit)
            ctx.beginPath();
            ctx.arc(650, 200, 25, 0, 2*Math.PI);
            ctx.fillStyle = '#ff9800';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.fillText('L2', 650, 200);

            // Lion 2's branches
            // NE branch (left)
            ctx.beginPath();
            ctx.moveTo(630, 220);
            ctx.lineTo(450, 300);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText('NE', 500, 250);

            // E branch (right)
            ctx.beginPath();
            ctx.moveTo(670, 220);
            ctx.lineTo(750, 300);
            ctx.stroke();
            ctx.fillText('E', 700, 250);

            // Terminal payoff for L2 NE
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('(1,0,0)', 450, 330);

            // Lion 3 node (moved left to fit)
            ctx.beginPath();
            ctx.arc(750, 320, 25, 0, 2*Math.PI);
            ctx.fillStyle = '#f44336';
            ctx.fill();
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = 'bold 18px Arial';
            ctx.fillText('L3', 750, 320);

            // Lion 3's branches
            // NE branch (left)
            ctx.beginPath();
            ctx.moveTo(730, 340);
            ctx.lineTo(550, 420);
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.stroke();
            ctx.fillStyle = 'black';
            ctx.font = '16px Arial';
            ctx.fillText('NE', 600, 370);

            // E branch (right)
            ctx.beginPath();
            ctx.moveTo(770, 340);
            ctx.lineTo(850, 420);
            ctx.stroke();
            ctx.fillText('E', 800, 370);

            // Terminal payoffs for Lion 3
            ctx.fillStyle = 'black';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('(-1,1,0)', 550, 450);
            ctx.fillText('(-1,-1,1)', 850, 450);

            // Legend (moved to fit)
            ctx.fillStyle = 'black';
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Legend:', 50, 450);
            ctx.fillText('E = Eat, NE = Not Eat', 50, 470);
            ctx.fillText('Payoffs: (L1, L2, L3)', 50, 490);
        }

        // Draw all trees
        const canvas1 = document.getElementById('tree1');
        const ctx1 = canvas1.getContext('2d');
        drawTree1(ctx1, canvas1);

        const canvas2 = document.getElementById('tree2');
        const ctx2 = canvas2.getContext('2d');
        drawTree2(ctx2, canvas2);

        const canvas3 = document.getElementById('tree3');
        const ctx3 = canvas3.getContext('2d');
        drawTree3(ctx3, canvas3);

        const canvas4 = document.getElementById('tree4');
        const ctx4 = canvas4.getContext('2d');
        drawTree4(ctx4, canvas4);

        const canvas5 = document.getElementById('tree5');
        const ctx5 = canvas5.getContext('2d');
        drawTree5(ctx5, canvas5);
        
        // Toggle answer visibility
        function toggleAnswer(answerId) {
            const answerElement = document.getElementById(answerId);
            answerElement.classList.toggle('show');
        }
    </script>
</body>
</html>